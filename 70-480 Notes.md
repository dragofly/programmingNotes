# 70-480 Notes

### Geolocation: `navigator.geolocation`
####  .getCurrentPosition()
   
```javascript
//Get current position
.getCurrentPosition(success(position), error(e), options?)
    position = { 
        coords : {
            latitude : 1.1
            longitude : 1.1
        },
        timestamp: 0 //when the request returned
    }
    e = { code : 0-3 } 
        // 1 - PERMISSION_DENIED, 
        // 2 - POSITION_UNAVELABLE
        // 3 - TIMEOUT
    options = {
        enableHighAccuracy : true, //try to find out more precise location (may take longer)
        timeout: 10000, // how long to try to get location (default: no limit)
        maximumAge: 1000 // how old the data can be before new position is calculated
    }
```

#### .watchLocation()

```javascript
 // gets location in intervals of options.maximumAge
let g = navigator.geolocation;
let watchID = g.watchLocation(success(), error(), options?);
g.clearWatch(watchID);
```

## Web storage: `window.localStorage/sessionStorage`
* Types:
	Local - bound to website not window
	Session - removed when window is closed
* Capacity: 2 - 10MB
* Security: per session/domain

```javascript
    
	.setItem(’myKey’, ’myValue’);
            // .myKey = ’myValue’;
            // [‘myKey’] = ‘myValue’;
	.getItem(’myKey’); 
            // .myKey; 
            // [‘myKey’];
	.removeItem(‘myKey’);
	.clear() // remove all data
	.length //number of keys added
	.remainingSpace // free space in B left
	:storage(e)
            e : {
                oldValue : 1,
                newValue : 3,
                key : ‘myKey’,
                url: ‘’,
                storageArea: ‘local/session’
            }
	error: 22 (QUOTA_EXCEEDED_ERR) 
```	

## Web workers: 

* Restrictions:
    - No accas to DOM, Window, Host page and jQuery (because it is depended on the Widnow)
    - Accas to: naviagator, timers, XmlHttpRequest

* Types:
    - Dedicated: bound to one window
    - Shared: can be called from multiple widnows

### Using web worker on web page
* `onmessage(f)` // result sent from the worker
* `onerror(f)` // handle error
* `postMessage(params)` // request for processing
```javascript
let worker = new Worker('myWorker.js');
worker.onmessage = function(e) {
    let result = e.data;
    console.log(result.summery);
}; // Workers send result
worker.onerror = function(errE) { console.log(errE.message)};
let params = { param1 : 'test', param: 2 };
worker.postMessage(params); //Sends data to worker
```

### Creating a web worker
* `addEventListener`('message', f(e), true) // listener for worker
* `postMessage`(results) // calls the .onmessage() int the UI thread
```javascript
function myEventHandler(e){
    let params = e.data;
    //do calculations here
    let reulsts = myCalculator(params.param1, params.param2);
    resutls['summery'] = 'Done';
    postMessage(resutls); //calls the onmessage function;
}

addEventListener('message', myEventHandler, true)
```

### Closing worker

* `.terminate()` // Closes the worker emedietly
Is called from the UI thread
```javascript
    let worker = new Worker('myWorker.js');
    worker.terminate();
```
* `.close()` // Waits for the worker to finish processing <br/>
Must be called from the worker not from the UI thread
```javascript
addEventListener('message'), function(e) {
    if(e.data.Command === 'close'){
        this.close();
    }
}
```

## Web sockets
Full duplex communication between server and clinet: boath server and client can send and receive messages at the same time without overhead. <br />
Websockets are using the websocket protocol (`ws`)that requires much less metadata (2B) then the standard httpreques/response (100+B)

### JS implementation
* `.onopen()`
* `.onclose()`
* `.onmessage(e)` // hadle message to server
* `.onerror(e)`
* `.send(params)` // send message to server

```javascript
let webSocket = window.WebSocket || window.MozWebSocket;
let ws = new webSocket('ws://localhost:8181/');
ws.onopen = function() {};
ws.onclose = function() {};
ws.onmessage  = function(e) {
    console.log(e.data);
};
ws.onerror =  = function(e) {};
ws.send('Hi');
```

### Server implementation
Implementation is done using Flek a C# library for handling WebSockets <br />
* `.OnOpen()` // add to sockets list
* `.OnClose()` // remove form socket list
* `.OnMessage()` // handle message form the client
* `.Send()` // send message to the client
```cs
var sockets = new List<IWebSocketConnection>();
var server = new Flek.WebSocketServer("ws://localhost:8181/");
server.Start(socket = () => 
{
    socket.OnOpen = () => 
    {
        sockets.Add(socket);
    };
    socket.OnClose = () =>
    {
        sockets.Remove(socket);
    };
    socket.OnMessage = message => {
        sockets.ToList().ForEach(s => s.send(message));
    };
}
)
```

## Microdata
Standard HTML markup + vocabulary namespace used to anotate pages so that programs can interact with the page. <br />
Rich snippets testing tool can be used to test what data can a machine read from your page.

* `itemscope itemtype`="http://data-vocabulary.org/Object"
    - itemscope : define a HTML container whose child elements contain properties of the described object
    - itemtype : defins the object the child HTML elements have values for
* `itemprop`="objectProp" // from the Person vocabulary
    - added to child element that contains property of the itemtpye object
    -  it will take the `text content` of that element, for specific types it will take scr, href, dateTime.
* `itemid`="MyUniuqeID"
    - scope uniuqe item ID
* `itemref`="row0-cell1 row1-cell1"
    - element IDs that are space separated
    - defines where the child elements are if the are not strucuted as child elements of the HTML object

```html
<div id="myInfo" itemscope itemtype="http://data-vocabulary.org/Person">
<h2 itemprop="name">Juraj Murgic>
    <div id="myAdress" itemscope itemtype="http://data-vocabulary/Adress">
    <span itemprop="region">Zagreb</span>
    </div>
</div>
```

## CSS

* History
    - CSS 1 1996
    - CSS 2 2004
    - CSS 3 In progress
        - Split into modules (smaller components that thefine one functionality)

* CSS structure
    - selector 
    - propertyName : value;
```css
body {
    background-color:#cccc99;
}
```

### Selectors

* Type selector
    - selector for html tag
```css
body { ... }
```
* ID selector
    - selects by html tag id
```css
#myID { ... }
```

* Class selector
    - select all html tags that contain that class
```css
.myClass { ... }
```

* Multiple selectors
    - selectors separated with comma
```css
.myClass, .myOtherClass { ... }
```

* Descendent selectors
    - separated with whitespace
    - searches <b>all descendes</b> of the first object
```css
div p { ... }
/* Will find all p that are under div */
```

* Child selectors
    - separated by `>`
    - searches all <b>direct discendes</b>
```css
div > p { ... }
/* Will find all p that are childern of div */
```

* Adjacent sibling
    - separated by +
    - selects <b>first</b> sibling that has the searched for values
```css
div.myClass + p { ... }
/* Will find FIRST p that is sibling of div.myClass */
```

* General sibling selector
    - selected by ~
    - selects all siblings of the element
```css
div.myClass ~ p { ... }
/* Will find ALL p that is sibling of div.myClass */
```   

* Attrbute sellectors
    - selected by brackets `[]`
        - `none`: has that attribute
        - `=`: attribute maches the whole expression in ""
        - `~=`: contains <b> word </b>
        - `|=`: starts with <b> word</b>
        - `^=`: begins with (not whole word)
        - `$=`: ends with (not whole word)
        - `*=`: contains (not whole word)
    - selects the html tags that have the value of the defined attribute
    - can define multiple attr selectors
```css
div[data-myAttr="myValue"][data-myAttr2="myValue2"] { ... }
/* Will find all div that have the data-myAttr attribute */
```

* Pseudo class attributes
    - seleced using `:`
    - selects the html tags that have a specified pseudo class
    - UI selectors
        - `:enabled`
        - `:disabled`
        - `:checked`
        - `:valid`
        - `:invalid`
        - `:required`
        - `:optional`
        - `:out-of-range`
        - `:in-range`
    - Structural selectors
        - `:root`
        - `:empty`
            - no text or comment
        - `:not(<simpleSelector>)`
            - will add to specificty
        - type
            - `:nth-of-type()`
            - `:nth-last-of-type()`
            - `:first-of-type`
            - `:last-of-type`
            - `:only-of-type`
        - child
            - `:nth-child()`
            - `:nth-last-child()`
            - `:first-child`
            - `:last-child`
            - `:only-child`
        - `:nth-()`
            - `(even)`
            - `(odd)`
            - `(an+b)`
                - `a` and `b` are variables, `n` is the counter
        - `:lang`
        - `:target` - selected anchor
        - `:link`
        - `:visited`
        - `:hover`
        - `:active`
        - `:focus`
        - elements
            - use with single `:` (becuse IE)
            - `::first-line`
            - `::first-letter`
            - `::selection` - the text that user seleceted with mouse
            - `::before`
            - `::after`
```css
div:visible { ... }
/* Will find all div that are visible to the user */
```

* Star selector
    - selected using `*`
    - selects all html tags
```css
* { ... }
/* Will find all html tags */
```

### Cascading

* Style sources
    - Default stylesheet: least weight 
        - browser defined
    - User stylesheet : more weight
        - default user stylesheet, defined per browser
    - Page stylesheet : moast weight
        - defined by the page authors
    - Last rule defined wins
        - For rules with same selectors
    - Inline rule wins over stylesheet rules
        - rule defined in the html tag using the `style` attribute
    - `!important` wins over other rules
        - can't be overriden

- Specificity
    - Style with the bigger value wins
    - A B C
        - A: count of ID selectors
        - B: count of attribute and class selectors
        - C: count of type selectors
    - weight:
        - 1-0-0 > 0-100-100

```css
*           /* a = 0 b = 0 c = 0 -> 0-0-0 */
li          /* a = 0 b = 0 c = 1 -> 0-0-1 */
li ul       /* a = 0 b = 0 c = 2 -> 0-0-2 */
li.myClass  /* a = 0 b = 1 c = 1 -> 0-1-1 */
#myID       /* a = 1 b = 0 c = 1 -> 1-0-0 */
```          
* Inheritance
    - Child elements inherit properties defined for the parent element unless they have their own rules defined

* Imports
    - use the `@import url(...)`
```css
@import url('myStiles/style2.css');
/* Will find all html tags */
```

### CSS reset
* Stylesheet that resets the user and browsers sytles so they don't apply to your page
    - include the reset.css as the first stylesheet or it will reset all the stylesheets that are imported before it

### Box model

* Components
    - Margin: between border and other boxes 
    - Border
    - Padding: between border and content in the box

* Vertical margins collapse
    - two consecutive li will have margin size that is overlaped
        - if boath li have margin of 5px then the space between them will be 5px not 10px = 5px + 5px

* Width
    - Sum of content, padding, border and margin

* Display
    - block: elements sit on top of each other
    - inline: elements are one next to each other, when they run out of space they move to next line
    - none: will not apear on the page or take up any space
        - visability: the item will not appear but will take up space on the page

### Fonts

* Font families
    - Serif - ends of lines have line
    - Sans-serif - no serifs
    - Cursive - like hand written letters
    - Fantasy - anythinkg goas
    - Monospace - all letters are same length (good for code)

```css
/* With fallbak fonts*/
body { font-family: Arial, Helvetica, san-serif; }
```

* Sizing
    - `px`: absolute styling
    - `em`: relative styling to a defined baseline

* Text properties
    - `text-indent`: how much the first element will be indented
    - `letter-spacing`: space between letters
    - `word-spacing`: space between words
    - `text-decoration`: line-through, etc.
    - `text-align`: position on the page

### Position

* Types:
    - `static`: elements are set one after the other (default)
    - `relative`: element is positon relative to its static position
        - cange the `top` and `left` props to move the element (can use negative values to go up and left)
    - `absolute`: element is position absoulte in regards to the <b>page</b>
    - `fixed`: element is position absoulte in regards to the <b>window</b> (element stays on the window if we scroll)

* Floating
    - `float`: move content to left/right of the page
        - can be used for two clomun layout
    - `clear`: clears the float of the so next element will have the default float

### Generate content

* Content that can be added using css. Can be styled.
* Restrictions:
    - Must have the `content:`
    - Can't be selected by the user
    - Not part of the DOM (not new nodes)
* Accepted values
    - empty: `` 
    - text: " .pdf " 
    - unicode: "\2603"
    - attributes: `attr(href)`
    - image: `url(/myImage.png)`
    - counters: "counter(myCounter)"
        - counter-increment: myCounter
        - counter-reset: myCounter
```css
p:before { content: "BeforeContent"; }
p:after { content: "AferContent"; }

/* Adding content in the node */
<p> BeforeContent OriginalContent AfterContent </p>
```

### Media queries

* Target media with specific capabilities
* Values (min/max):
    - `-width`
    - `-heigth`
    - `-device-width`
    - `-device-height`
    - `orientation: potrait/landscape`
    - `-aspect-ratio`
    - `-device-aspect-ratio`
* Punctuation
    - `only`
    - `and`
    - `not`
    - `,`: or

```css
@media screen {
    p { ... }
}
```

* supports
    - does the browser support specific functionality

```css
@supports (display: table-cell) {
    p { ... }
}
```  

- ``









